<html>
<head>
<title>
Exploit Exercises
</title>
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<link href="/assets/application-623947d16d4882a61a6f2b4989f100c2.css" media="all" rel="stylesheet" type="text/css"/>
<script src="/assets/application-5a3ba6b1be2bd14e7cd5f9ea081b673a.js" type="text/javascript"></script>
 
 
 
 
<meta content="authenticity_token" name="csrf-param"/>
<meta content="lT3V9YCpVUzcJYWQC0YpJ5F9nQJWheSx3U8FiR/HEFU=" name="csrf-token"/>
</head>
<body>
<div class='navbar navbar-inverse navbar-fixed-top' role='navigation'>
<div class='container'>
<div class='navbar-header'>
<button class='navbar-toggle' data-target='.navbar-collapse' data-toggle='collapse' type='button'>
<span class='sr-only'>Toggle navigation</span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
</button>
<a class='navbar-brand' href='/'>exploit-exercises.com</a>
</div>
<div class='navbar-collapse collapse' id='navbar-main'>
<ul class='nav navbar-nav' id='main-menu-left'>
<li class=''>
<a href='/download'>Download</a>
</li>
<li class='active dropdown'>
<a class='dropdown-toggle' data-toggle='dropdown' href='#'>
Exercises
<b class='caret'></b>
</a>
<ul class='dropdown-menu'>
<li class=''>
<a href='/nebula'>Nebula</a>
</li>
<li class=''>
<a href='/protostar'>Protostar</a>
</li>
<li class='active'>
<a href='/fusion'>Fusion</a>
</li>
<li class=''>
<a href='/mainsequence'>Main Sequence</a>
</li>
</ul>
 
</li>
<li class=''>
<a href='/news'>News</a>
</li>
<li>
<a href='http://blog.exploit-exercises.com'>Blog</a>
</li>
<li class=''>
<a href='/commercialuse'>Commercial Use</a>
</li>
</ul>
</div>
</div>
</div>
<div class='container'>
<div class='row-fluid'>
<div class='col-md-3'>
<div class='well'>
<h5>Follow us on twitter</h5>
<p>
<a class='twitter-follow-button' data-show-count='false' href='https://twitter.com/exploitexercise'>
Follow @exploitexercise
</a>
<script>
$(document).ready(function(){
  $.getScript('//platform.twitter.com/widgets.js');
});
</script>
</p>
</div>
<a class='coinbase-button' data-button-style='donation_small' data-code='f73be53062028d4850f73ba39083ebff' href='https://coinbase.com/checkouts/f73be53062028d4850f73ba39083ebff'>Donate Bitcoins</a>
<div class='list-group'>
<div class='list-group-item'>
<h4 class='list-group-heading'>Fusion</h4>
</div>
<a class='list-group-item ' href='/fusion/level00'>Level 00</a>
<a class='list-group-item ' href='/fusion/level01'>Level 01</a>
<a class='list-group-item ' href='/fusion/level02'>Level 02</a>
<a class='list-group-item ' href='/fusion/level03'>Level 03</a>
<a class='list-group-item ' href='/fusion/level04'>Level 04</a>
<a class='list-group-item ' href='/fusion/level05'>Level 05</a>
<a class='list-group-item ' href='/fusion/level06'>Level 06</a>
<a class='list-group-item ' href='/fusion/level07'>Level 07</a>
<a class='list-group-item ' href='/fusion/level08'>Level 08</a>
<a class='list-group-item ' href='/fusion/level09'>Level 09</a>
<a class='list-group-item ' href='/fusion/level10'>Level 10</a>
<a class='list-group-item ' href='/fusion/level11'>Level 11</a>
<a class='list-group-item active' href='/fusion/level12'>Level 12</a>
<a class='list-group-item ' href='/fusion/level13'>Level 13</a>
<a class='list-group-item ' href='/fusion/level14'>Level 14</a>
<a class='list-group-item ' href='/fusion/level15'>Level 15</a>
<a class='list-group-item ' href='/fusion/level16'>Level 16</a>
<a class='list-group-item ' href='/fusion/level17'>Level 17</a>
<a class='list-group-item ' href='/fusion/level18'>Level 18</a>
<a class='list-group-item ' href='/fusion/level19'>Level 19</a>
<a class='list-group-item ' href='/fusion/level20'>Level 20</a>
<a class='list-group-item ' href='/fusion/level21'>Level 21</a>
<a class='list-group-item ' href='/fusion/level22'>Level 22</a>
<a class='list-group-item ' href='/fusion/level23'>Level 23</a>
<a class='list-group-item ' href='/fusion/level24'>Level 24</a>
<a class='list-group-item ' href='/fusion/level25'>Level 25</a>
<a class='list-group-item ' href='/fusion/level26'>Level 26</a>
<a class='list-group-item ' href='/fusion/level27'>Level 27</a>
<a class='list-group-item ' href='/fusion/level28'>Level 28</a>
</div>
</div>
<div class='col-md-9'>
<div id='flash_messages'></div>
<div id='content'>
<div class='alert alert-error hide' id='error_notice_div'>
 
</div>
<div class='alert alert-warning hide' id='warning_notice_div'>
 
</div>
<div class='alert alert-info hide' id='notice_notice_div'>
 
</div>
<div class='alert alert-success hide' id='success_notice_div'>
 
</div>
<div class='page-header'>
<h1>Fusion level12</h1>
</div>
<h2>About</h2>
There is no description available for this level.
<table class='table table-striped table-condensed table-hover'>
<tbody>
<tr>
<td>Vulnerability Type</td>
<td>
<span class='label label-info'>
Stack
</span>
</td>
</tr>
<tr>
<td>Position Independent Executable</td>
<td>
<span class='label label-important'>No</span>
</td>
</tr>
<tr>
<td>Read only relocations</td>
<td>
<span class='label label-important'>No</span>
</td>
</tr>
<tr>
<td>Non-Executable stack</td>
<td>
<span class='label label-success'>Yes</span>
</td>
</tr>
<tr>
<td>Non-Executable heap</td>
<td>
<span class='label label-success'>Yes</span>
</td>
</tr>
<tr>
<td>Address Space Layout Randomisation</td>
<td>
<span class='label label-success'>Yes</span>
</td>
</tr>
<tr>
<td>Source Fortification</td>
<td>
<span class='label label-important'>No</span>
</td>
</tr>
</tbody>
</table>
<h2>Source code</h2>
<div class="CodeRay">
<div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span><span style="color:#579">#include</span> <span style="color:#B44;font-weight:bold">&quot;../common/common.c&quot;</span>&#x000A;<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>&#x000A;<span class="line-numbers"> <a href="#n3" name="n3">3</a></span><span style="color:#777">/*</span>&#x000A;<span class="line-numbers"> <a href="#n4" name="n4">4</a></span><span style="color:#777"> * The aim of this level is to redirect code execution by overwriting an entry</span>&#x000A;<span class="line-numbers"> <a href="#n5" name="n5">5</a></span><span style="color:#777"> * in the global offset table.</span>&#x000A;<span class="line-numbers"> <a href="#n6" name="n6">6</a></span><span style="color:#777"> */</span>&#x000A;<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>&#x000A;<span class="line-numbers"> <a href="#n8" name="n8">8</a></span><span style="color:#088;font-weight:bold">void</span> callme()&#x000A;<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>{&#x000A;<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>  printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hmmm, how did this happen?</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>);&#x000A;<span class="line-numbers"><a href="#n11" name="n11">11</a></span>  system(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">exec /bin/sh</span><span style="color:#710">&quot;</span></span>);&#x000A;<span class="line-numbers"><a href="#n12" name="n12">12</a></span>}&#x000A;<span class="line-numbers"><a href="#n13" name="n13">13</a></span>&#x000A;<span class="line-numbers"><a href="#n14" name="n14">14</a></span><span style="color:#088;font-weight:bold">void</span> echo(<span style="color:#0a8;font-weight:bold">char</span> *string)&#x000A;<span class="line-numbers"><a href="#n15" name="n15">15</a></span>{&#x000A;<span class="line-numbers"><a href="#n16" name="n16">16</a></span>  printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">You said, </span><span style="color:#b0b">\&quot;</span><span style="color:#710">&quot;</span></span>);&#x000A;<span class="line-numbers"><a href="#n17" name="n17">17</a></span>  printf(string);&#x000A;<span class="line-numbers"><a href="#n18" name="n18">18</a></span>  printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\&quot;</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>);&#x000A;<span class="line-numbers"><a href="#n19" name="n19">19</a></span>  fflush(stdout);&#x000A;<span class="line-numbers"><strong><a href="#n20" name="n20">20</a></strong></span>}&#x000A;<span class="line-numbers"><a href="#n21" name="n21">21</a></span>&#x000A;<span class="line-numbers"><a href="#n22" name="n22">22</a></span><span style="color:#0a8;font-weight:bold">int</span> main(<span style="color:#0a8;font-weight:bold">int</span> argc, <span style="color:#0a8;font-weight:bold">char</span> **argv, <span style="color:#0a8;font-weight:bold">char</span> **envp)&#x000A;<span class="line-numbers"><a href="#n23" name="n23">23</a></span>{&#x000A;<span class="line-numbers"><a href="#n24" name="n24">24</a></span>  <span style="color:#0a8;font-weight:bold">int</span> fd;&#x000A;<span class="line-numbers"><a href="#n25" name="n25">25</a></span>  <span style="color:#0a8;font-weight:bold">char</span> *p;&#x000A;<span class="line-numbers"><a href="#n26" name="n26">26</a></span>&#x000A;<span class="line-numbers"><a href="#n27" name="n27">27</a></span>  background_process(NAME, UID, GID);  &#x000A;<span class="line-numbers"><a href="#n28" name="n28">28</a></span>  fd = serve_forever(PORT);&#x000A;<span class="line-numbers"><a href="#n29" name="n29">29</a></span>  set_io(fd);&#x000A;<span class="line-numbers"><strong><a href="#n30" name="n30">30</a></strong></span>&#x000A;<span class="line-numbers"><a href="#n31" name="n31">31</a></span>  printf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Basic echo server. Type 'quit' to exit</span><span style="color:#b0b">\n</span><span style="color:#710">&quot;</span></span>);&#x000A;<span class="line-numbers"><a href="#n32" name="n32">32</a></span>&#x000A;<span class="line-numbers"><a href="#n33" name="n33">33</a></span>  <span style="color:#080;font-weight:bold">while</span>(<span style="color:#00D">1</span>) {&#x000A;<span class="line-numbers"><a href="#n34" name="n34">34</a></span>    <span style="color:#0a8;font-weight:bold">char</span> input[<span style="color:#00D">1024</span>];&#x000A;<span class="line-numbers"><a href="#n35" name="n35">35</a></span>    memset(input, <span style="color:#00D">0</span>, <span style="color:#080;font-weight:bold">sizeof</span>(input));&#x000A;<span class="line-numbers"><a href="#n36" name="n36">36</a></span>&#x000A;<span class="line-numbers"><a href="#n37" name="n37">37</a></span>    fgets(input, <span style="color:#080;font-weight:bold">sizeof</span>(input)-<span style="color:#00D">1</span>, stdin);&#x000A;<span class="line-numbers"><a href="#n38" name="n38">38</a></span>    <span style="color:#080;font-weight:bold">if</span>(strlen(input) == <span style="color:#00D">0</span> || strncmp(input, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">quit</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">4</span>) == <span style="color:#00D">0</span>) {&#x000A;<span class="line-numbers"><a href="#n39" name="n39">39</a></span>      exit(<span style="color:#00D">0</span>);&#x000A;<span class="line-numbers"><strong><a href="#n40" name="n40">40</a></strong></span>    }    &#x000A;<span class="line-numbers"><a href="#n41" name="n41">41</a></span>    &#x000A;<span class="line-numbers"><a href="#n42" name="n42">42</a></span>    <span style="color:#080;font-weight:bold">if</span>((p = strchr(input, <span style="color:#D20">'\r'</span>)) != <span style="color:#069">NULL</span>) *p = <span style="color:#00D">0</span>;&#x000A;<span class="line-numbers"><a href="#n43" name="n43">43</a></span>    <span style="color:#080;font-weight:bold">if</span>((p = strchr(input, <span style="color:#D20">'\n'</span>)) != <span style="color:#069">NULL</span>) *p = <span style="color:#00D">0</span>;&#x000A;<span class="line-numbers"><a href="#n44" name="n44">44</a></span>&#x000A;<span class="line-numbers"><a href="#n45" name="n45">45</a></span>    echo(input);&#x000A;<span class="line-numbers"><a href="#n46" name="n46">46</a></span>  }&#x000A;<span class="line-numbers"><a href="#n47" name="n47">47</a></span>}</pre></div>
</div>
<h2>Discussion</h2>
<div id='disqus_thread'></div>
<script>
$(document).ready(function() {
  <!-- * * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */ -->
  var disqus_shortname = 'exploitexercises'; // required: replace example with your forum shortname
  // var disqus_identifer = 'test';
  var disqus_developer = 1;
  var disqus_url = "https://exploit-exercises.com/fusion/level12";
  // var disqus_identifier = "/fusion/level12";
  <!-- * * * DON'T EDIT BELOW THIS LINE * * */ -->
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
});


</script>
<noscript>
Please enable JavaScript to view the
<a href='https://disqus.com/?ref_noscript'>comments powered by Disqus.</a>
</noscript>
</div>
</div>
</div>
</div>
<script>
$(document).ready(function() {
  // Set up Cookies
  Flash.transferFromCookies();
  Flash.writeDataTo('error', $('#error_notice_div'));
  Flash.writeDataTo('notice', $('#notice_notice_div'));
  Flash.writeDataTo('warning', $('#warning_notice_div'));
  Flash.writeDataTo('success', $('#success_notice_div'));
});  

$(document).ready(function() {
  var data = JSON.parse(unescape($.cookie("username")));
  $.cookie('username',null, {path: '/'});

  if(!data) {
    $('.loggedin').hide();
    return;
  }
  $('.loggedoff').hide();
  $('#account_name').empty().append(data);
  
});
</script>
 
<script type='text/javascript'>
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-25780546-1']);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>
<script>
$(document).ready(function(){
  $.getScript("https://coinbase.com/assets/button.js");
});
</script>
</body>
</html>
