<html>
<head>
<title>
Exploit Exercises
</title>
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<link href="/assets/application-623947d16d4882a61a6f2b4989f100c2.css" media="all" rel="stylesheet" type="text/css"/>
<script src="/assets/application-5a3ba6b1be2bd14e7cd5f9ea081b673a.js" type="text/javascript"></script>
 
 
 
 
<meta content="authenticity_token" name="csrf-param"/>
<meta content="xl1Q80mtC+GlkbRJTvVh+tHUlcCYQWpatk9yrTcTOpQ=" name="csrf-token"/>
</head>
<body>
<div class='navbar navbar-inverse navbar-fixed-top' role='navigation'>
<div class='container'>
<div class='navbar-header'>
<button class='navbar-toggle' data-target='.navbar-collapse' data-toggle='collapse' type='button'>
<span class='sr-only'>Toggle navigation</span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
</button>
<a class='navbar-brand' href='/'>exploit-exercises.com</a>
</div>
<div class='navbar-collapse collapse' id='navbar-main'>
<ul class='nav navbar-nav' id='main-menu-left'>
<li class=''>
<a href='/download'>Download</a>
</li>
<li class='active dropdown'>
<a class='dropdown-toggle' data-toggle='dropdown' href='#'>
Exercises
<b class='caret'></b>
</a>
<ul class='dropdown-menu'>
<li class=''>
<a href='/nebula'>Nebula</a>
</li>
<li class=''>
<a href='/protostar'>Protostar</a>
</li>
<li class=''>
<a href='/fusion'>Fusion</a>
</li>
<li class='active'>
<a href='/mainsequence'>Main Sequence</a>
</li>
</ul>
 
</li>
<li class=''>
<a href='/news'>News</a>
</li>
<li>
<a href='http://blog.exploit-exercises.com'>Blog</a>
</li>
<li class=''>
<a href='/commercialuse'>Commercial Use</a>
</li>
</ul>
</div>
</div>
</div>
<div class='container'>
<div class='row-fluid'>
<div class='col-md-3'>
<div class='well'>
<h5>Follow us on twitter</h5>
<p>
<a class='twitter-follow-button' data-show-count='false' href='https://twitter.com/exploitexercise'>
Follow @exploitexercise
</a>
<script>
$(document).ready(function(){
  $.getScript('//platform.twitter.com/widgets.js');
});
</script>
</p>
</div>
<a class='coinbase-button' data-button-style='donation_small' data-code='13c7b093d39c0e9b70e154ca0d68ffe0' href='https://coinbase.com/checkouts/13c7b093d39c0e9b70e154ca0d68ffe0'>Donate Bitcoins</a>
<div class='list-group'>
<a class='list-group-item '>
Main Sequence
</a>
<a class='list-group-item active' href='/mainsequence/storyline'>
Story Line
</a>
<a class='list-group-item ' href='/mainsequence/setup'>
Setup Instructions
</a>
<div class='list-group-item'>
<h4 class='list-group-heading'>Levels</h4>
</div>
<a class='list-group-item ' href='/mainsequence/irate-manticore'>
Irate Manticore
</a>
<a class='list-group-item  ' href='/mainsequence/touchy-owl'>
Touchy Owl
</a>
<a class='list-group-item ' href='/mainsequence/wild-amphibian'>
Wild Amphibian
</a>
<a class='list-group-item ' href='/mainsequence/storming-bear'>
Storming Bear
</a>
<a class='list-group-item  ' href='/mainsequence/screaming-jesus'>
Screaming Jesus
</a>
<a class='list-group-item ' href='/mainsequence/fabled-scorpion'>
Fabled Scorpion
</a>
<a class='list-group-item ' href='/mainsequence/selfish-dragonfly'>
Selfish Dragonfly
</a>
<a class='list-group-item  ' href='/mainsequence/vicious-platypus'>
Vicious Platypus
</a>
</div>
</div>
<div class='col-md-9'>
<div id='flash_messages'></div>
<div id='content'>
<div class='alert alert-error hide' id='error_notice_div'>
 
</div>
<div class='alert alert-warning hide' id='warning_notice_div'>
 
</div>
<div class='alert alert-info hide' id='notice_notice_div'>
 
</div>
<div class='alert alert-success hide' id='success_notice_div'>
 
</div>
<div class='page-header'>
<h1>Ruxcon 2012 CTF Storyline</h1>
</div>
<div id='toc'></div>
<div class='alert alert-info'>
<p>
The following story line stuff is a work of fiction, any
resemblance / name space collisions to anybody living or
dead, past or present, is completely coincidental.
</p>
</div>
<h2 id='announcement'>Announcement</h2>
<p>
JPanic, rumoured to herald from the trumpets of the digital gods, who
incarnated this mythical beast to dominate the digital underground.
Upon this immaculate conception he ruled over the 90s VX Scene,
sprinkling his magic, 16 bits at a time.
</p>
<p>
Introducing techniques to the scene so advanced for that time, they
seemed alien. JPanic caused quite the
<em>Immortal Riot</em>
wherever he roamed.
</p>
<p>
As technology progressed, word size increased to 64bits, Russians
gained dominance in crimeware, and gigabit network connections
became the norm (except in Australia), the presence of JPanic
seemingly disappeared. For those in the know, the beast has been
quietly sleeping in the underground, for over a decade now, not
seen or heard of since the great #hpaus war of 1999. But
something is a-miss, disturbing rumblings from the underground
have been detected recently, some even claim the sleeping
giant has awoken, and he's fucking pissed...
</p>
<p>
Meanwhile, young up-start, Buo, still scarred by the memories of
JPanic mercilessly beating Retch to within an inch of his life
at Seccon 98, is forging himself a fine and noble career as a
anti-malware analyst. Loved by all, Buo has quickly established
himself as the young rising star and golden boy at Lambsky
AntiVirus. One boring day while trawling through malware samples,
Buo comes across something interesting!
</p>
<p>
A mysterious sample submitted by a dormant honeypot in Pakistan
that has not reported anything for the past 5 years. The sample
is packed in a strange and unrecognisable format. Buo gives his
friend Silvio a call and describes the characteristics of the
sample: 'an obfuscated decryptor which unpacks an obfuscated body,
with both the decryptor and body changing on each execution'.
Silvio advises Buo that it sounds like a polymorphic virus and not
to worry. Buo rolls his eyes and sighs as he puts the phone down
and gets back to work.
</p>
<p>
After several days of carefully stepping through assembly code,
peeling back several layers of obfuscation, and circumnavigating
numerous anti-debugging tricks, Buo is finally able to take a small
glimpse inside a tiny portion of the packed sample. He manages to
capture a string located at offset 0x7dfb
</p>
<pre>'CAPZLOQ TECHNIQ II ELECTRIC BOOGALOO ... JPANIC &gt; BUO'.</pre>
<p>A cold chill shoots up Buo's spine....</p>
<p>(and Buo wee's himself a little)</p>
<h2 id='about'>About</h2>
<p>
Assist JPanic on his crusade to cleanse the Internet or help Buo
stop JPanic before it is too late!
</p>
<p>
The CTF game is made up of a series of levels based on the scallywag
behaviour of JPanic, and the heroics of our white-knight Buo. All
the levels can be played at your own leisure and level difficulty
ranges from easy to moderate.
</p>
<h2 id='challenges'>Challenges</h2>
<ul>
<li>Client-Side Ownage</li>
<li>SQL Injection</li>
<li>Dotslash Technique</li>
<li>Reverse Engineering and Binary Analysis</li>
<li>Basic Exploit Development</li>
<li>Basic Forensics</li>
<li>Unix Insecurities</li>
<li>Network Attacks</li>
<li>Logic Bugs</li>
<li>Ascii Jump!</li>
<li>Watch other players</li>
</ul>
<h2 id='chapters'>Chapters</h2>
<h3 id='irate-manticore'>Irate Manticore</h3>
<p>
Buo takes the malicious sample home to examine it further. While reversing
a particularly difficult part of the code, Buo jumps on to openrce.org to
ask for assistance and ideas. A user called 'Sepultura' (AKA Jpanique)
responds...
</p>
<p>Upon completion, the following is displayed</p>
<p>
Jpanic ponders... 'did I check Buo's desktop carefully' as he accidentally
stumbles over a waste paper basket he had been scrawling notes on to.
</p>
<h4 id='awe-inspiring-serpent'>Awe-inspiring Serpent</h4>
<p>
Buo has once mentioned on openrce.org that he keeps all sorts of useful
information on his desktop background picture, in order to keep information
fresh in his mind. Getting that background picture information may provide
information for future compromise.
</p>
<h4 id='glowing-marsupial'>Glowing Marsupial</h4>
<p>
The background picture revealed a network map of Buo's home network,
amongst other things. The "file server" target looks interesting.
</p>
<p>
It looks like you'll need to compromise it via the desktop computer,
as there is no direct route externally from the network to this server.
</p>
<h4 id='hungry-wombat'>Hungry Wombat</h4>
<p>
Documents from the file server reveals an analysis of JPanic's
work-in-progress "Hammertime" virus code at c:\hammertime\. We need
to see how much of the code has been analysed.
</p>
<p>
You'll need to disable the counter measures, privilege escalate,
or compromise the system somehow to get the code.
</p>
<p>
You may need to bounce off the file server in order to compromise
the machine.
</p>
<p>Upon completion, the following text is displayed:</p>
<p>
JPanic learns that Buo has been telling all and sundry about his
work in progress and the discovery so far. Buo suspects that virus
author is Australian, and the Australian Federal Police are quite
interested in opening a case. Additionally, Buo has been in frequent
contact to Mikko Hypponen who is on his way to Australia to be a
guest judge on Australian Idol.
</p>
<p>
Media attention is not something
that Jpanic wants at this time.
</p>
<h3 id='touchy-owl'>Touchy Owl</h3>
<p>
JPanic was a little sloppy when he owned up Buo as the IDS running on
Buo’s network has recorded an IP address which has accessed his file
server. Buo is very concerned to learn that someone has penetrated his
home network, and he has no idea what they’ve done and if they have
left a backdoor behind. The only thing Buo has to work with is an IP
address. After some quick research Buo finds that the IP address belongs
to a shell box located in Russia. The shellbox is locked down pretty
hard and Buo is unable to hack it. Through some quick cmlh style
‘google hacking’ Buo is able to discover that people using the shell
box often visit a particular virus trading forum.
</p>
<p>
Buo believes that he can find out some more information about who owned
his home desktop by hacking the Virus Training Underground web forum
system. Help Buo penetrate the forum and find some interesting information.
</p>
<p>
The aim of this mission will be to compromise their database information
about the users of the system.
</p>
<h4 id='nuclear-tipped-koala'>Nuclear-tipped Koala</h4>
<p>
Now that the database has been compromised from
<em>Operation Touchy Owl,</em>
it is time to try and crack some users passwords in order to log in
to the website
</p>
<h4 id='boxing-kangaroo'>Boxing Kangaroo</h4>
<p>
With access to the website obtained, it is now time to try and get access
to the administrator account.
</p>
<p>
Now that administrator access to the website has been obtained, investigate
the possibilities further and see if shell access can be obtained to that
host.
</p>
<p>
It is suspected that this host may be useful for further client side attacks
and information gathering techniques against virus developers and traders.
</p>
<h4 id='desert-muskrat'>Desert Muskrat</h4>
<p>
Investigate the system for files and information that may be used for
future attacks.
</p>
<p>Upon completion, the following is displayed:</p>
<p>
Buo comes across 4 strange binaries named
</p>
<ul>
<li>wild-amphibian</li>
<li>necessary-griffin</li>
<li>congested-demon</li>
<li>enraged-bandicoot</li>
</ul>
<p>
Buo has a feeling the files contain some important information about the attacker.
He stashes the files away to take a look at later. Lets see what other problems
Buo can find with the host.
</p>
<h4 id='green-squirrel'>Green Squirrel</h4>
<p>
Examine the host and look for misconfiguration that disclose a lot of
information that allows further compromises to happen.
</p>
<p>Upon completion, the following is displayed:</p>
<p>Investigating the secret directory Buo discovers a note</p>
<blockquote>
‘Gday Dark Angel, The proof of concept code you require can be found in
the files wild-amphibian, necessary-griffin, congested-demon,
and enraged-bandicoot. Tell Retch to get off your nutz. Your pal,
Sepultura.’
</blockquote>
<p>
Buo also finds a bunch of encrypted messages which he stores away to take
a look at later.
</p>
<p>
Interesting... Sepultra was the same guy on the
reverseengineering subreddit. Buo decides taking a look at the binaries
is a high priority now.
</p>
<h3 id='wild-amphibian'>Wild Amphibian</h3>
<p>
During
<a href='#desert-muskrat'></a>
Operation Desert Muskrat
an unusual binary was found on that system.
</p>
<h4 id='necessary-griffin'>Necessary Griffin</h4>
<p>
During
<a href='#desert-muskrat'>Operation Desert Muskrat</a>
an unusual binary was found on that system.
</p>
<h4 id='congested-demon'>Congested Demon</h4>
<p>
During
<a href='#desert-muskrat'>Operation Desert Muskrat</a>
an unusual binary was found on that system.
</p>
<h4 id='enraged-bandicoot'>Enraged Bandicoot</h4>
<p>
During
<a href='#desert-muskrat'>Operation Desert Muskrat</a>
an unusual binary was found on that system. Cursory examination
indicates that is an exploit of some type.
</p>
<p>Upon completing that level, the following text is displayed</p>
<p>
From analysing the files Buo is able to discovers that the POC
files contain concept code that has also been used in the
mysterious sample captured by the honeypot. Buo is able to link
Sepultura to the sample, giving him something solid to chase.
</p>
<h3 id='mountain-minotaur'>Mountain Minotaur</h3>
<p>
During
<a href='#desert-muskrat'>Operation Desert Muskrat</a>
some snippets of emails was found that referenced a shell script
for parsing XML files. Based off the following exchange, it might
be possible to exploit the shell script to get access to this
persons system.
</p>
<blockquote>
First you need to gather the file containing the XML data. The
specific information that we're after is in the &lt;src
type=\"url\"&gt;...&lt;/src&gt; bit. So we'll extract that using
pcregrep, and storing it in a temporary file. In order to make
it work for your other shell script that processes it, we'll
store it so that it can be read in with the bash source command,
with contents in URLS.
</blockquote>
<h3 id='storming-bear'>Storming Bear</h3>
<p>
As part of the operations investigating JPanic, we've managed
to capture some potentially interesting information from his
network communications. Investigate the packet capture
to find out more.
</p>
<h4 id='wise-teacher'>Wise Teacher</h4>
<p>
As part of the operations investigating JPanic, we've managed
to capture some potentially interesting information from his
network communications. Investigate the packet capture
to find out more.
</p>
<h4 id='hungry-lover'>Hungry Lover</h4>
<p>
As part of the operations investigating JPanic, we've managed
to capture some potentially interesting information from his
network communications. Investigate the packet capture
to find out more.
</p>
<h4 id='fearsome-crocodile'>Fearsome Crocodile</h4>
<p>
As part of the operations investigating JPanic, we've managed
to capture some potentially interesting information from his
network communications. Investigate the packet capture
to find out more.
</p>
<h3 id='screaming-jesus'>Screaming Jesus</h3>
<p>
During the
<a href='#fearsome-crocodile'>Fearsome Crocodile</a>
operation, we found that that JPanic planned to flee his his
current residence and hide from law enforcement. We have found
a note that appears to be encrypted.
</p>
<h4 id='delirious-troll'>Delirious Troll</h4>
<p>
During the
<a href='#fearsome-crocodile'>Fearsome Crocodile</a>
operation, we found that that JPanic planned to flee his his
current residence and hide from law enforcement. We have found
a note that appears to be encrypted.
</p>
<h4 id='loyal-dog'>Loyal Dog</h4>
<p>
During the
<a href='#fearsome-crocodile'>Fearsome Crocodile</a>
operation, we found that that JPanic planned to flee his his
current residence and hide from law enforcement. We have found
a note that appears to be encrypted.
</p>
<h4 id='wrathful-lion'>Wrathful Lion</h4>
<p>
During the
<a href='#fearsome-crocodile'>Fearsome Crocodile</a>
operation, we found that that JPanic planned to flee his his
current residence and hide from law enforcement. We have found
a note that appears to be encrypted.
</p>
<h4 id='cruel-tiger'>Cruel Tiger</h4>
<p>
During the
<a href='#fearsome-crocodile'>Fearsome Crocodile</a>
operation, we found that that JPanic planned to flee his his
current residence and hide from law enforcement. We have found
a note that appears to be encrypted.
</p>
<h3 id='fabled-scorpion'>Fabled Scorpion</h3>
<p>
JPanic needs some 0day to help propagate his worm. He hears about a stash
being sat on by DevineInt. A menacing call to Retch reveals that
DevineInt's server contains suitable code. Scan that machine and see
if you can compromise it.
</p>
<h4 id='plunging-wolverine'>Plunging Wolverine</h4>
<p>
Log into the plunging-wolverine account with the token you got from the
<a href='#fabled-scorpion'>Fabled Scorpion</a>
level. Take a look at /home/level0 directory.
</p>
<h4 id='parched-loudmouth'>Parched Loudmouth</h4>
<p>
Log into the parched-loudmouth account with the password
'parched-loudmouth' (without quotes). Take a look at /home/level1
directory.
</p>
<h4 id='awesome-badger'>Awesome Badger</h4>
<p>
Log into the parched-loudmouth account with the password
'parched-loudmouth' (without quotes). Take a look at /home/level2
directory.
</p>
<h4 id='unproved-otter'>Unproved Otter</h4>
<p>
Log into the unproved-otter account with the password 'unproved-otter'
(without quotes). Take a look at /home/level3 directory.
</p>
<h3 id='selfish-dragonfly'>Selfish Dragonfly</h3>
<p>
There is a Web server that on port 20000 on exploit-exercises.com that takes
HTTP requests in reverse. Make a request for /token.
</p>
<h4 id='wild-jellyfish'>Wild Jellyfish</h4>
<p>
There is a web server on port 20001 on exploit-exercises.com that requires
authentication. You can perform a timing attack on the authentication
scheme. There is a logic issue with the code in that if a byte matches,
the request takes longer to process.
</p>
<h3 id='vicious-platypus'>Vicious Platypus</h3>
<p>
JPANIC STRIKES BACK
</p>
<p>
JPanic has decided to strike back against the Lambsky company. With 75%
market share, he's decided to throughly embarass the company via
simultaneous assaults on their mailing list, company blog, and virus
update procedure. Get started by examining the robots.txt
and audit the software password reset functionality.
</p>
<h4 id='laughing-kookaburra'>Laughing Kookaburra</h4>
<p>
Next up on the jpanic revenge is the BuoAV company blog. Gain access
to the blog administrative account.
</p>
<h4 id='poison-paradox'>Poison Paradox</h4>
<p>
Last, but not least, is the admin access page for the BuoAV company.
</p>
<p>
You'll have to use information you've gathered from early on in order
to do this. This
<em>Buo</em>
picture may come in use!
</p>
<h3 id='bonus-round'>Bonus Round</h3>
<p>
BUO GOES ON HOLIDAY -- asciijump @ 10.10.50.8
</p>
</div>
</div>
</div>
</div>
<script>
$(document).ready(function() {
  // Set up Cookies
  Flash.transferFromCookies();
  Flash.writeDataTo('error', $('#error_notice_div'));
  Flash.writeDataTo('notice', $('#notice_notice_div'));
  Flash.writeDataTo('warning', $('#warning_notice_div'));
  Flash.writeDataTo('success', $('#success_notice_div'));
});  

$(document).ready(function() {
  var data = JSON.parse(unescape($.cookie("username")));
  $.cookie('username',null, {path: '/'});

  if(!data) {
    $('.loggedin').hide();
    return;
  }
  $('.loggedoff').hide();
  $('#account_name').empty().append(data);
  
});
</script>
 
<script type='text/javascript'>
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-25780546-1']);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>
<script>
$(document).ready(function(){
  $.getScript("https://coinbase.com/assets/button.js");
});
</script>
</body>
</html>
