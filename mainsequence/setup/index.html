<html>
<head>
<title>
Exploit Exercises
</title>
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<link href="/assets/application-623947d16d4882a61a6f2b4989f100c2.css" media="all" rel="stylesheet" type="text/css"/>
<script src="/assets/application-5a3ba6b1be2bd14e7cd5f9ea081b673a.js" type="text/javascript"></script>
 
 
 
 
<meta content="authenticity_token" name="csrf-param"/>
<meta content="1cqo+6d7rWCcrOggXDNzT978iThgtEofXPdeNt4v5wc=" name="csrf-token"/>
</head>
<body>
<div class='navbar navbar-inverse navbar-fixed-top' role='navigation'>
<div class='container'>
<div class='navbar-header'>
<button class='navbar-toggle' data-target='.navbar-collapse' data-toggle='collapse' type='button'>
<span class='sr-only'>Toggle navigation</span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
</button>
<a class='navbar-brand' href='/'>exploit-exercises.com</a>
</div>
<div class='navbar-collapse collapse' id='navbar-main'>
<ul class='nav navbar-nav' id='main-menu-left'>
<li class=''>
<a href='/download'>Download</a>
</li>
<li class='active dropdown'>
<a class='dropdown-toggle' data-toggle='dropdown' href='#'>
Exercises
<b class='caret'></b>
</a>
<ul class='dropdown-menu'>
<li class=''>
<a href='/nebula'>Nebula</a>
</li>
<li class=''>
<a href='/protostar'>Protostar</a>
</li>
<li class=''>
<a href='/fusion'>Fusion</a>
</li>
<li class='active'>
<a href='/mainsequence'>Main Sequence</a>
</li>
</ul>
 
</li>
<li class=''>
<a href='/news'>News</a>
</li>
<li>
<a href='http://blog.exploit-exercises.com'>Blog</a>
</li>
<li class=''>
<a href='/commercialuse'>Commercial Use</a>
</li>
</ul>
</div>
</div>
</div>
<div class='container'>
<div class='row-fluid'>
<div class='col-md-3'>
<div class='well'>
<h5>Follow us on twitter</h5>
<p>
<a class='twitter-follow-button' data-show-count='false' href='https://twitter.com/exploitexercise'>
Follow @exploitexercise
</a>
<script>
$(document).ready(function(){
  $.getScript('//platform.twitter.com/widgets.js');
});
</script>
</p>
</div>
<a class='coinbase-button' data-button-style='donation_small' data-code='13c7b093d39c0e9b70e154ca0d68ffe0' href='https://coinbase.com/checkouts/13c7b093d39c0e9b70e154ca0d68ffe0'>Donate Bitcoins</a>
<div class='list-group'>
<a class='list-group-item '>
Main Sequence
</a>
<a class='list-group-item ' href='/mainsequence/storyline'>
Story Line
</a>
<a class='list-group-item active' href='/mainsequence/setup'>
Setup Instructions
</a>
<div class='list-group-item'>
<h4 class='list-group-heading'>Levels</h4>
</div>
<a class='list-group-item ' href='/mainsequence/irate-manticore'>
Irate Manticore
</a>
<a class='list-group-item  ' href='/mainsequence/touchy-owl'>
Touchy Owl
</a>
<a class='list-group-item ' href='/mainsequence/wild-amphibian'>
Wild Amphibian
</a>
<a class='list-group-item ' href='/mainsequence/storming-bear'>
Storming Bear
</a>
<a class='list-group-item  ' href='/mainsequence/screaming-jesus'>
Screaming Jesus
</a>
<a class='list-group-item ' href='/mainsequence/fabled-scorpion'>
Fabled Scorpion
</a>
<a class='list-group-item ' href='/mainsequence/selfish-dragonfly'>
Selfish Dragonfly
</a>
<a class='list-group-item  ' href='/mainsequence/vicious-platypus'>
Vicious Platypus
</a>
</div>
</div>
<div class='col-md-9'>
<div id='flash_messages'></div>
<div id='content'>
<div class='alert alert-error hide' id='error_notice_div'>
 
</div>
<div class='alert alert-warning hide' id='warning_notice_div'>
 
</div>
<div class='alert alert-info hide' id='notice_notice_div'>
 
</div>
<div class='alert alert-success hide' id='success_notice_div'>
 
</div>
<h2>Irate Manticore</h2>
<h3>Installation Steps</h3>
<p>
Since it's not feasible to redistribute Microsoft Windows, you will need to provide and setup a Windows XP SP2 32bit image, and then install
<a href='http://www.sandboxie.com'>SandboxIE.</a>
</p>
<p>
Do not download or install any updates for Windows.
</p>
<p>
Configure SandboxIE to restrict everything as much as possible. Create the directory c:\hammertime, make the file c:\hammertime\token.txt. Configure SandboxIE to forbid access to that directory for restricted processes. Once SandboxIE is configured, start up a sandboxed Internet Explorer.
</p>
<div class='alert alert-info'>
<p>
You can test if Internet Explorer is appropriately restricted by trying to access file://c:/hammertime/token.txt,
it should prevent access to that file.
</p>
</div>
<p>
The desktop picture should be created (via MS Paint), and stored in c:\windows\system32, and set as the background picture. There should be some obvious information stored there, such as a token, and this
<a href='https://www.google.com/chart?chs=200x200&amp;chld=M|0&amp;cht=qr&amp;chl=otpauth:%2f%2ftotp%2fadmin@buoav.com%3Fsecret%3Daaaabbbbccccdddd'>image.</a>
</p>
<p>
The desktop picture should also have a rough diagram of the network with the FreeBSD server's machine.
</p>
<p>
Create a file called "auth details.txt" with the contents of "admin / Sizzlechest". Put that file in the recycling bin.
</p>
<div class='alert alert-info'>
<p>
During the Ruxcon CTF, the admin / Sizzlechest was obtained by visiting a physical location. Hard to replicate that online though :-)
</p>
</div>
<h3>Configure Network</h3>
<p>
The network layout for Irate Manticore should look like the following:
</p>
<p>
[external network] - [vm host] - [irate manticore and glowing marsupial]
</p>
<p>
The network for irate-manticore and glowing-marsupial should be set up so that all traffic from them is NAT'd, and that no external network traffic is able to reach it. Due to the variety of virtual machine software and operating system combinations possible, more specific instructions are not provided.
</p>
<h3>Running</h3>
<div class='alert alert-info'>
<p>
You may wish to save the machine state now, so that you can go back to a pristine image as required.
</p>
</div>
<p>
Ensure that Internet Explorer is maximized, along with another application (such as notepad).
In Internet Explorer, navigate to your chosen URL.
</p>
<div class='alert alert-info'>
<p>
During the Ruxcon 2012 CTF, this part of the code was automated by polling the main CTF website and gettig
the target URL from it.
</p>
</div>
<h3>Glowing Marsupial</h3>
<p>
Install a FreeBSD 8.2 x86 system, and enable the telnet service by uncommenting a line in /etc/inetd.conf, and restarting inetd. You may wish to install socat as well to make the attackers job a bit easier.
</p>
<div class='alert alert-warning'>
<p>
The aim behind Irate Manticore and Glowing Marsupial is to demonstrate network pivoting by first completing a client side attack, using the client side'd machine to attack the FreeBSD system, and then finally using the
FreeBSD system to exploit the original machine to bypass SandboxIE.
</p>
</div>
<h2>Touchy Owl</h2>
<p>Touchy Owl is distributed as a bootable cd-rom image, therefore, no special setup instructions are required.</p>
<p>Touchy Owl requires port 80 to be reachable, either via port forwarding, or suitable network setup.</p>
<h2>Wild Amphibian</h2>
<p>Wild Amphibian is distributed as a zip file, so nothing special is required.</p>
<h2>Storming Bear</h2>
<p>Storming Bear is distributed as a zip file, so nothing special is required.</p>
<h2>Screaming Jesus</h2>
<p>Screaming Jesus is distributed as a zip file, so nothing special is required.</p>
<h2>Fabled Scorpion</h2>
<p>
Fabled Scorpion is distributed as a bootable cd-rom image, therefore, no special setup instructions are required.
</p>
<p>
Fabled Scorpion requires port 79, and 22 to be reachable, either via port forwarding, or suitable network setup.
</p>
<h2>Selfish Dragonfly</h2>
<p>
Please follow the instructions on the
<a href='/mainsequence/selfish-dragonfly'>Selfish Dragonfly</a>
page.
</p>
<h2>Vicious Platypus</h2>
<p>
Vicious Platypus is distributed as a bootable cd-rom image, therefore, no special setup instructions are required.
</p>
<p>
One of the levels of fabled-scorpion requires a SMTP server - by default it will connect to mailinator.com.
</p>
</div>
</div>
</div>
</div>
<script>
$(document).ready(function() {
  // Set up Cookies
  Flash.transferFromCookies();
  Flash.writeDataTo('error', $('#error_notice_div'));
  Flash.writeDataTo('notice', $('#notice_notice_div'));
  Flash.writeDataTo('warning', $('#warning_notice_div'));
  Flash.writeDataTo('success', $('#success_notice_div'));
});  

$(document).ready(function() {
  var data = JSON.parse(unescape($.cookie("username")));
  $.cookie('username',null, {path: '/'});

  if(!data) {
    $('.loggedin').hide();
    return;
  }
  $('.loggedoff').hide();
  $('#account_name').empty().append(data);
  
});
</script>
 
<script type='text/javascript'>
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-25780546-1']);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>
<script>
$(document).ready(function(){
  $.getScript("https://coinbase.com/assets/button.js");
});
</script>
</body>
</html>
